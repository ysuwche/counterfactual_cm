#傾向スコアを用いたIPW
#傾向スコアは先ほど求めた値を使う
D = z
Y = y

E_Y1= np.sum((D/ps_score)*Y)/np.sum(D/ps_score)
E_Y0 = np.sum(((1 - D) / (1 - ps_score))*Y) / np.sum((1 - D) / (1 - ps_score))

ATE = E_Y1 - E_Y0
print(ATE)
